---
layout: post
title: CTF
date: 2025-12-20
tags:
  - CTF
---





```bash
NSSCTF{}
```


## Png

对于一个PNG文件来说，其文件头总是由位固定的字节来描述的，

`.PNG`

```c
89 50 4E 47 0D 0A 1A 0A
```

标准的PNG文件结构

```c
`.PNG` `IHDR` `IDAT` `IEND`
```



### strings 扫描

```c
strings 1.png
```

实例结果

```c
C:\Users\86182\Downloads>strings 1.png
IHDR
IDATx
?{ S
?{ S
?,W%
777}
(NuS
?[!S
1Kf&
&RKN
UL~b
_sIMX
'O$^R
(NuS
o<}y
3I      X
$$?k
1k#xU
WxbXK<
oUyM~A
3f-c
qFQ:)
OLm-9
(NUK<1
/Ev7}U
L<{5
_sIMX
W]fp
a-cb
!fILN
oUyM~A
/Ev7}U
y/>]
&#+P
od/d
I       _3
I       _3
I       _3
I       _3
IEND
```

没什么信息

### 010editor

或者其他十六进制查看/编辑器

搜索`{` 或者`}`

![image-20251226231914750](https://cdn.jsdelivr.net/gh/violet-wdream/Drawio/PNG/202512262319860.png)

复制为十六进制文本

```
7B 20 53 01 FB 2F 53 7D
7B 20 53 01 FB 2F 53 7D
7B 35 8F 7D
```



### pngcheck

[pnggroup/pngcheck: Development of pngcheck 4](https://github.com/pnggroup/pngcheck)

下载源码进入根目录cmd

```bash
cmake .
cmake --build . --config Release
```

使用实例

```bash
pngcheck 1.png
#OK: 1.png (213x213, 24-bit RGB, non-interlaced, static, 97.7%).

pngcheck -v 1.png
#File: 1.png (3097 bytes)
#  chunk IHDR at offset 0x0000c, length 13
#    213 x 213 image, 24-bit RGB, non-interlaced
#  chunk IDAT at offset 0x00025, length 3040
#    zlib: deflated, 32K window, superfast compression
#  chunk IEND at offset 0x00c11, length 0
#No errors detected in 1.png (3 chunks, 97.7% compression).
```



### LSB隐写

#### zsteg

[zsteg隐写分析工具](https://tools.qsnctf.com/misc/zsteg)

搜索`text` `{}`相关

![image-20251226235430950](https://cdn.jsdelivr.net/gh/violet-wdream/Drawio/PNG/202512262354042.png)



#### StegSolve

[StegOnline](https://www.georgeom.net/StegOnline/extract)

依次查看R G B为0时输出数据。

![image-20251227000746140](https://cdn.jsdelivr.net/gh/violet-wdream/Drawio/PNG/202512270007177.png)





## 文本txt

### 词频分析





## WebShell

### 工具

[蚁剑](https://github.com/AntSwordProject/antSword/releases/tag/2.1.15) 源码

[加载器](https://github.com/AntSwordProject/AntSword-Loader/releases) 启动器启动后需要初始化，选择源码根目录。

Fiddler打开的时候会修改SSL证书导致picgo图片上传失败。

BurpSuite 

### 直接连接

![image-20251227121533702](https://cdn.jsdelivr.net/gh/violet-wdream/Drawio/PNG/202512271215229.png)

提示需要POST `wllm`，暗示webshell连接密码为`wllm`

使用蚁剑连接

![image-20251227121642239](https://cdn.jsdelivr.net/gh/violet-wdream/Drawio/PNG/202512271216287.png)

手动查找flag，发现在顶层目录下。

![image-20251227121731086](https://cdn.jsdelivr.net/gh/violet-wdream/Drawio/PNG/202512271217146.png)

或者使用命令行搜索

```bash
find / -name "*flag*" 2>/dev/null
```

![image-20251227122057580](https://cdn.jsdelivr.net/gh/violet-wdream/Drawio/PNG/202512271220639.png)

cat打印

![image-20251227122243895](https://cdn.jsdelivr.net/gh/violet-wdream/Drawio/PNG/202512271222924.png)

### Payload

```php
<?php
highlight_file('index.php');
include("flag.php");
$id=$_POST['id'];
$json=json_decode($_GET['json'],true);
if ($id=="wllmNB"&&$json['x']=="wllm")
{echo $flag;}
?>
```

提示需要发送POST 和 GET，需要满足id为`wllmNB` 以及` json['x']=="wllm"`

打开fiddler，选择composer组件

URL，默认http1.1

```php
http://node7.anna.nssctf.cn:27699/index.php
```

添加GET参数

转义工具[URL 编码/解码 - 锤子在线工具](https://www.toolhelper.cn/EncodeDecode/Url?type=2)


```js
key: json 
value: {"x":"wllm"}
#注意这里需要使用转义字符
value: %7B%22x%22%3A%22wllm%22%7D
```



设置 Request Headers 

```php
Content-Type: application/x-www-form-urlencoded
```

填写 Request Body ，在body选择form-urlencoded

```php
id=wllmNB
```

![image-20251227130202280](https://cdn.jsdelivr.net/gh/violet-wdream/Drawio/PNG/202512271309565.png)

最后的结果为

```http
POST http://node7.anna.nssctf.cn:27699/index.php?json=%7B%22x%22%3A%22wllm%22%7D HTTP/1.1
Host:node7.anna.nssctf.cn:27699
User-Agent:Fiddler-Everywhere
Content-Type:application/x-www-form-urlencoded
Content-Length:9

id=wllmNB
```

执行得到flag

![image-20251227130844556](https://cdn.jsdelivr.net/gh/violet-wdream/Drawio/PNG/202512271309121.png)





## 加密/解密

### 工具

[cyphey](https://github.com/bee-san/Ciphey?tab=readme-ov-file)命令行工具，需要python3.8.8安装，推荐使用anaconda

安装具体细节参考

[(43 封私信) 用Anaconda安装ciphey的过程记录 - 知乎](https://zhuanlan.zhihu.com/p/731018889)



```bash
ciphey -t 4O595954494Q32515046324757595N534R52415653334357474R4N575955544R4O5N4Q46434S4O59474253464Q5N444R4Q51334557524O5N4S424944473542554O595N44534O324R49565746515532464O49345649564O464R4R494543504N35
ciphey -f encrypted.txt
```



![image-20251228201109595](https://cdn.jsdelivr.net/gh/violet-wdream/Drawio/PNG/202512282011624.png)

分析过程：

原密文

```
4O595954494Q32515046324757595N534R52415653334357474R4N575955544R4O5N4Q46434S4O59474253464Q5N444R4Q51334557524O5N4S424944473542554O595N44534O324R49565746515532464O49345649564O464R4R494543504N35
```

首先统计一下出现的字符集，0~9和NOQRS，字母数量特别少而且是相邻字符，疑似是偏移过的Base16

```python
#!/usr/bin/env python3
import sys
from collections import Counter

def main():
    if len(sys.argv) < 2:
        print("用法: python count_chars.py <字符串>")
        sys.exit(1)

    input_str = sys.argv[1]  # 获取第一个参数作为输入字符串
    counts = Counter(input_str)  # 统计字符出现次数

    # 按字符排序输出
    for char in sorted(counts):
        print(f"'{char}': {counts[char]}")

if __name__ == "__main__":
    main()
```

![image-20251228204307644](https://cdn.jsdelivr.net/gh/violet-wdream/Drawio/PNG/202512282043677.png)

NOQRS对应偏移的ABDEF，如果是偏移的则offset = ‘N’ - ‘A’ = 78 - 65 = 13

[caesar](https://www.lddgo.net/encrypt/caesar-cipher)还原为

```
4B595954494D32515046324757595A534E52415653334357474E4A575955544E4B5A4D46434F4B59474253464D5A444E4D51334557524B5A4F424944473542554B595A44534B324E49565746515532464B49345649564B464E4E494543504A35
```

再使用Base16解密得到

```
KYYTIM2QPF2GWYZSNRAVS3CWGNJWYUTNKZMFCOKYGBSFMZDNMQ3EWRKZOBIDG5BUKYZDSK2NIVWFQU2FKI4VIVKFNNIECPJ5
```

分析字符集包括部分数字和大写字母，刚好符合Base32的字符集

![image-20251228204822526](https://cdn.jsdelivr.net/gh/violet-wdream/Drawio/PNG/202512282048560.png)

尝试使用Base32解密得到

```
V143Pytkc2lAYlV3SlRmVXQ9X0dVdmd6KEYpP3t4V29+MElXSER9TUEkPA==
```

结尾有两个=，直接猜测是Base64，进行解密得到

```
W^7?+dsi@bUwJTfUt=_GUvgz(F)?{xWo~0IWHD}MA$<
```

可以看到这里有很多特殊符号，猜测是Base85或者Base91

如果用91进行解密会直接得到乱码，肯定不正确。

```
��W*!��H���9��N$� � �xptr�R�`Nl�
```

但是如果用85进行解密，会提示开头不能是`W`，这里是因为大部分解密工具选择的算法不对。需要选择RFC1924算法。[Base85 Encoder And Decoder](https://nerdmosis.com/tools/encode-and-decode-base85#:~:text=An all-zero group is encoded as,a single character ‘z’ instead of ‘!!!’.)

最后得到flag为

![image-20251228205450499](https://cdn.jsdelivr.net/gh/violet-wdream/Drawio/PNG/202512282054543.png)

### Caesar

偏移量

### BaseX

X表示的是编码字符数量

#### Base16

0123456789ABCDEF

没有小写字母，特点只有6种大写字母

#### Base32

ABCDEFGHIJKLMNOPQRSTUVWXYZ234567

没有小写字母，只有部分数字，缺少数字0 1 8 9

#### Base58

123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz

没有0



#### Base62

0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz



#### Base64

ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=

结尾一般有= 比较好辨别，有大小写数字。



#### Base85

有多种算法[Base85 Encoder And Decoder](https://nerdmosis.com/tools/encode-and-decode-base85#:~:text=An all-zero group is encoded as,a single character ‘z’ instead of ‘!!!’.)

包括 Adobe, Ascii, RFC1924, Z85 等

**Ascii85** 标准（`!` 到 `u`）

!"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]^_`abcdefghijklmnopqrstu

**Z85**（ZeroMQ 提出）：使用完全可打印的 85 个字符，不包括容易混淆的字符（如 `"`、`\` 等）

有很多特殊符号



#### Base91

ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!#$%&()*+,./:;<=>?@[]^_`{|}~"

包括数字，字母，符号，没有反斜杠\，单引号‘

### AES





### RSA 非对称加密

RSA公开密钥密码体制的原理是：根据数论，寻求两个大素数比较简单，而将它们的乘积进行因式分解却极其困难，因此可以将乘积公开作为加密密钥。



1. **选择两个大素数** p 和 q

2. 计算：
   $$
   n=p×q
   $$
   这里 n 称为 **模数**，它决定了密钥长度（通常 1024~4096 位）

3. 计算欧拉函数：
   $$
   ϕ(n)=(p−1)(q−1)
   $$
   

4. 选择公钥指数 e，满足：
   $$
   1<e<ϕ(n),gcd(e,ϕ(n))=1
   $$
   gcd是最大公约数

5. 计算私钥指数 d：
   $$
   d≡e^{−1}(mod \spaceϕ(n))
   $$

| 密钥类型           | 内容   |
| ------------------ | ------ |
| 公钥 (public key)  | (n, e) |
| 私钥 (private key) | (n, d) |

##  加密与解密

- **加密**（用公钥加密消息 m）：

$$
c≡m^e(mod\space n)
$$



- **解密**（用私钥还原消息 c）：

$$
m≡c^d(mod\space n)
$$

这里 m 要转为整数表示（通常用 `bytes_to_long` 转换）。



### MD5

